# =====================================
# SECURE M-PESA MCP ENVIRONMENT CONFIG
# =====================================

# Database Configuration (Updated for Security)
DB_HOST=your-db-host
DB_PORT=5432
DB_NAME=your-db-name
DB_USER=mpesa_application          # ✅ Use secure application user
DB_PASSWORD=your-secure-app-password-change-this  # ✅ Strong password
DB_MIN_SIZE=2
DB_MAX_SIZE=10

# ✅ CRITICAL: Database Encryption Key (32 bytes for AES-256)
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
DB_ENCRYPTION_KEY=your-64-character-hex-encryption-key-change-this-in-production

# Flask Configuration
SECRET_KEY=your-super-secret-flask-key-change-this
FLASK_HOST=0.0.0.0
FLASK_PORT=5000
FLASK_DEBUG=false                  # ✅ Never true in production

# JWT Configuration
JWT_EXPIRY_HOURS=24
JWT_SECRET_KEY=your-jwt-secret-key-different-from-flask  # ✅ Separate JWT key

# M-Pesa Configuration (Global defaults)
MPESA_SANDBOX_URL=https://sandbox.safaricom.co.ke

# Security Configuration
# ✅ Rate limiting
DEFAULT_RATE_LIMIT=1000
RATE_LIMIT_WINDOW_MINUTES=60

# ✅ Session security
SESSION_TIMEOUT_MINUTES=30
MAX_FAILED_LOGINS=5
ACCOUNT_LOCKOUT_MINUTES=15

# ✅ Audit configuration
AUDIT_LOG_RETENTION_DAYS=365
ENABLE_AUDIT_CHECKSUMS=true

# ✅ SSL/TLS Configuration (Production)
SSL_CERT_PATH=/path/to/ssl/cert.pem
SSL_KEY_PATH=/path/to/ssl/key.pem
FORCE_HTTPS=true

# ✅ Additional Security Headers
ENABLE_SECURITY_HEADERS=true
CSP_POLICY="default-src 'self'; script-src 'self' 'unsafe-inline'"

# ✅ Monitoring and Alerting
ENABLE_SECURITY_MONITORING=true
ALERT_EMAIL=security@yourdomain.com
WEBHOOK_URL=https://your-monitoring-service.com/webhook

# ✅ Backup Configuration
BACKUP_ENCRYPTION_KEY=different-key-for-backups-64-chars-long
BACKUP_SCHEDULE_HOURS=24
BACKUP_RETENTION_DAYS=90

# ✅ Key Management (Production - use proper KMS)
KMS_PROVIDER=aws_kms  # or azure_kms, gcp_kms, hashicorp_vault
KMS_KEY_ID=your-kms-key-id
KMS_REGION=us-west-2

# Development vs Production
ENVIRONMENT=production  # or development, staging
LOG_LEVEL=INFO         # DEBUG only in development

# =====================================
# PRODUCTION SECURITY CHECKLIST
# =====================================
# ✅ All keys are randomly generated and unique
# ✅ Database passwords are strong and rotated regularly  
# ✅ Encryption keys are stored in proper KMS
# ✅ SSL/TLS is enabled and certificates are valid
# ✅ Debug mode is disabled
# ✅ Rate limiting is configured appropriately
# ✅ Audit logging is enabled
# ✅ Security headers are enabled
# ✅ Monitoring and alerting is configured
# ✅ Backup encryption is enabled
